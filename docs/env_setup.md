# [환경 설정 가이드] LetterCast Pro - Environment Setup

## 1. 사전 요구사항

| 항목 | 최소 버전 | 비고 |
|---|---|---|
| Python | 3.11+ | `python3 --version`으로 확인 |
| Poetry | 1.7+ | 패키지 매니저 |
| Google Chrome | 최신 | NotebookLM 자동화용 |
| Git | 2.x | 버전 관리 |

## 2. 프로젝트 초기 설정

```bash
# 1. 저장소 클론
git clone <repository-url> letter-cast
cd letter-cast

# 2. Poetry로 가상환경 및 의존성 설치
poetry install

# 3. Playwright 브라우저 설치
poetry run playwright install chromium

# 4. 설정 파일 생성
cp config/.env.example config/.env
cp config/settings.example.yaml config/settings.yaml
```

## 3. Gmail OAuth 2.0 인증 설정

### 3.1 Google Cloud Console 설정
1. [Google Cloud Console](https://console.cloud.google.com/) 접속
2. 새 프로젝트 생성 (또는 기존 프로젝트 선택)
3. **API 및 서비스 → 라이브러리** → `Gmail API` 검색 후 **사용 설정**
4. **API 및 서비스 → 사용자 인증 정보** → **사용자 인증 정보 만들기** → **OAuth 클라이언트 ID**
5. 애플리케이션 유형: **데스크톱 앱** 선택
6. JSON 파일 다운로드 → `config/credentials.json`으로 저장

### 3.2 최초 인증 실행
```bash
# 최초 1회 실행 시 브라우저가 열리며 구글 계정 인증 진행
poetry run python -m src.collector.gmail_auth

# 인증 완료 후 config/token.json 자동 생성
```

> [!IMPORTANT]
> `token.json`과 `credentials.json`은 절대 Git에 커밋하지 마세요. `.gitignore`에 이미 등록되어 있습니다.

## 4. 텔레그램 봇 설정

### 4.1 봇 생성
1. 텔레그램에서 [@BotFather](https://t.me/BotFather)에게 `/newbot` 명령 전송
2. 봇 이름과 username 설정
3. 발급받은 **API Token**을 `config/.env`의 `TELEGRAM_BOT_TOKEN`에 입력

### 4.2 채널 설정
1. 텔레그램에서 새 채널 생성 (비공개 권장)
2. 생성한 봇을 채널의 **관리자**로 추가 (메시지 게시 권한 필요)
3. 채널 ID 확인:
   ```bash
   # 채널에 임의 메시지 전송 후 아래 URL 접속
   https://api.telegram.org/bot<TOKEN>/getUpdates
   # 응답의 chat.id 값을 config/.env의 TELEGRAM_CHANNEL_ID에 입력
   ```

## 5. 크롬 프로필 설정 (NotebookLM용)

NotebookLM은 구글 계정 로그인이 필요하므로, 기존 크롬 프로필을 활용합니다.

### macOS 기본 경로
```
~/Library/Application Support/Google/Chrome/Default
```

### 설정 확인
```bash
# 크롬 프로필 경로 확인 — 크롬 주소창에 입력
chrome://version
# "프로필 경로" 항목을 config/settings.yaml의 chrome_user_data_dir에 입력
```

> [!WARNING]
> Playwright 실행 시 동일 프로필로 크롬이 이미 실행 중이면 충돌합니다. 자동화 전에 크롬을 종료하거나, 별도 프로필을 생성하세요.

## 6. 환경 변수 (.env 템플릿)

```env
# config/.env

# === Gmail ===
GMAIL_CREDENTIALS_PATH=config/credentials.json
GMAIL_TOKEN_PATH=config/token.json

# === Telegram ===
TELEGRAM_BOT_TOKEN=your-bot-token-here
TELEGRAM_CHANNEL_ID=-100xxxxxxxxxx

# === Chrome ===
CHROME_USER_DATA_DIR=~/Library/Application Support/Google/Chrome
CHROME_PROFILE=Default

# === General ===
LOG_LEVEL=INFO
```

## 7. 설정 완료 확인

```bash
# 전체 설정 검증 스크립트
poetry run python -m src.check_setup

# 기대 출력:
# ✅ Python 3.11+ ... OK
# ✅ Gmail credentials ... OK
# ✅ Telegram bot connection ... OK
# ✅ Chrome profile found ... OK
# ✅ SQLite database ... OK
# ✅ All checks passed!
```

---
*Generated by Gemini 2.0 Flash*
