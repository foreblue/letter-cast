# [기능 명세서] 개인용 멀티 채널 팟캐스트 자동화 시스템 (LetterCast Pro)

## 1. 시스템 개요
본 시스템은 **Gmail(특정 발신자)**과 **직접 지정한 웹페이지(블로그, 뉴스 등)**에서 최신 콘텐츠의 URL을 자동으로 수집하고, 이를 Google NotebookLM의 'Website' 소스 기능을 통해 오디오로 변환하여 개인 텔레그램 채널로 배달하는 개인 전용 자동화 워크플로우입니다.

## 2. 데이터 소싱 아키텍처
`[Multi-Channel Inputs]` → `[NotebookLM Automation]` → `[Telegram Delivery]`

*   **Input A (Gmail):** 특정 뉴스레터 발신자로부터 온 메일 내 본문 링크 추출.
*   **Input B (Web):** 즐겨찾는 웹사이트/블로그의 최신 게시글 링크 추출.
*   **Process:** Playwright를 이용한 NotebookLM UI 자동화 (Website 소스 추가).

## 3. 상세 기능 요구사항

### 3.1 멀티 채널 수집 (Collector)
시스템은 두 가지 채널에서 콘텐츠 URL을 확보합니다.

*   **Gmail 채널:**
    *   설정된 발신자 리스트(`ALLOWED_SENDERS`)와 일치하는 '읽지 않음' 메일을 탐색합니다.
    *   메일 본문에서 정규표현식을 사용하여 실제 기사로 연결되는 메인 URL을 추출합니다.
*   **웹 채널:**
    *   설정된 웹사이트 리스트(`TARGET_WEBSITES`)를 순회합니다.
    *   RSS 피드가 있다면 RSS를 파싱하고, 없다면 Playwright로 접속하여 최신 첫 번째 기사의 링크를 추출합니다.

### 3.2 데이터 통합 및 필터링 (Aggregator)
*   **URL 큐 관리:** 수집된 모든 URL을 하나의 작업 리스트로 통합합니다.
*   **중복 제거:** 로컬 SQLite DB 또는 JSON 파일을 참조하여 이미 오디오로 변환된 적이 있는 URL은 제외합니다.
*   **최신성 유지:** 최근 24시간 이내에 생성된 콘텐츠만 처리 대상으로 삼습니다.

### 3.3 NotebookLM 자동화 (Automator)
본문 스크래핑 없이 NotebookLM의 자체 기능을 활용합니다.

*   **브라우저 세션:** 맥북의 실제 크롬 프로필(User Data Directory)을 사용하여 로그인 상태를 유지합니다.
*   **소스 추가 (Website):**
    1.  NotebookLM 접속 후 새 노트북 생성.
    2.  `Add Source` -> `Website` 옵션 선택.
    3.  수집된 URL을 입력 필드에 주입하고 `Insert` 실행.
*   **분석 대기:** Google이 웹사이트 콘텐츠 분석을 완료할 때까지 대기합니다.
*   **오디오 생성:** 'Audio Overview'의 `Generate` 버튼을 클릭하고 생성이 완료될 때까지 브라우저를 유지합니다.

### 3.4 파일 배달 및 정리 (Delivery)
*   **파일 다운로드:** 생성된 MP3 파일을 로컬 임시 폴더로 저장합니다.
*   **텔레그램 전송:** 텔레그램 봇을 통해 오디오 파일과 제목, 출처 URL을 메시지로 전송합니다.
*   **리소스 정리:** 작업이 끝난 임시 노트북은 삭제하거나 보관 처리하여 NotebookLM 계정 용량을 관리합니다.
